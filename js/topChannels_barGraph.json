{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "height": 600,
  "width": 1400,
  "description": "A bar chart showing the top YouTube channels with a filter to control how many channels are displayed.",
  "data": {
    "url": "https://raw.githubusercontent.com/Abdeali-007/FIT3179-WK10-HW/main/Global%20YouTube%20Statistics.csv"
  },
  "transform": [
    {
      "filter": "datum.rank <= slider_rank"
    },
    {
      "calculate": "datum.Country == 'nan' ? 'Unknown' : datum.Country",
      "as": "Country_fixed"
    },
    {
      "calculate": "datum['video views'] < 1000 ? 'N/A' : format(datum['video views'], ',d')",
      "as": "views_fixed"
    },
    {
      "calculate": "datum.uploads < 10 ? 'N/A' : format(datum.uploads, ',d')",
      "as": "uploads_fixed"
    }
  ],
  "params": [
    {
      "name": "slider_rank",
      "value": 15,
      "bind": {
        "input": "range",
        "min": 1,
        "max": 50,
        "step": 1,
        "name": "Number of Top Channels "
      }
    }
  ],
  "layer": [
    {
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "Youtuber",
          "type": "nominal",
          "title": "YouTube Channel",
          "sort": {
            "field": "rank",
            "order": "ascending"
          },
          "axis": {
            "labelAngle": -45
          }
        },
        "y": {
          "field": "subscribers",
          "type": "quantitative",
          "title": "Subscribers",
          "axis": {
            "format": ",d",
            "grid": false
          }
        },
        "color": {
          "field": "Country_fixed",
          "type": "nominal",
          "title": "Country",
          "scale": {
            "domain": ["United States", "India", "Japan", "United Kingdom", "Russia", "South Korea", "Brazil", "Canada", "Unknown", "Argentina", "Chile"],
            "range": ["#a6cee399","#1f78b499","#b2df8a99","#33a02c99","#fb9a9999","#fdbf6f99","#ff7f0099","#cab2d699","#6a3d9a99","#ffff9999","#b1592899"]
          } 
        },
        "tooltip": [
          {
            "field": "rank",
            "type": "nominal",
            "title": "Rank"
          },
          {
            "field": "Youtuber",
            "type": "nominal",
            "title": "Channel"
          },
          {
            "field": "subscribers",
            "type": "quantitative",
            "title": "Subscribers",
            "format": ",d"
          },
          {
            "field": "Country_fixed",
            "type": "nominal",
            "title": "Country"
          },
          {
            "field": "views_fixed",
            "type": "nominal",
            "title": "Video Views"
          },
          {
            "field": "uploads_fixed",
            "type": "nominal",
            "title": "Uploads"
          }
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "center",
        "baseline": "bottom",
        "dy": -5
      },
      "encoding": {
        "x": {
          "field": "Youtuber",
          "type": "nominal",
          "sort": {
            "field": "rank",
            "order": "ascending"
          }
        },
        "y": {
          "field": "subscribers",
          "type": "quantitative"
        },
        "text": {
          "field": "rank",
          "type": "nominal"
        }
      }
    },
    {
      "mark": {
        "type": "rect",
        "fill": "#f0f0f0",
        "stroke": "#000",
        "strokeWidth": 1,
        "cornerRadius": 5,
        "x": 1145,
        "y": 97,
        "width": 315,
        "height": 60
      },
      "encoding": {}
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "x": 1000,
        "y": 80,
        "fontSize": 12,
        "fontWeight": "normal"
      },
      "encoding": {
        "text": {
          "value": "The majority of the top YouTube channels originate from"
        },
        "color": {
          "value": "black"
        }
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "x": 1000,
        "y": 95,
        "fontSize": 12,
        "fontWeight": "normal"
      },
      "encoding": {
        "text": {
          "value": " the United States and India, highlighting the significant"
        },
        "color": {
          "value": "black"
        }
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "x": 1000,
        "y": 110,
        "fontSize": 12,
        "fontWeight": "normal"
      },
      "encoding": {
        "text": {
          "value": "influence these countries have on the platform."
        },
        "color": {
          "value": "black"
        }
      }
    }
  ],
  "config": {
    "background": "#f9f9f9"
  }
}
