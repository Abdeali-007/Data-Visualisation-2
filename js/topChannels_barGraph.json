{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text": "Top YouTube Channels by Subscriber Count", "fontSize": 20},
  "width": 800,
  "height": 600,
  "description": "A bar chart showing the top YouTube channels with a filter to control how many channels are displayed.",
  "data": {
    "url": "https://raw.githubusercontent.com/Abdeali-007/FIT3179-WK10-HW/main/Global%20YouTube%20Statistics.csv"
  },
  "transform": [
    {"filter": "datum.rank <= slider_rank"},
    {
      "calculate": "datum.Country == 'nan' ? 'Unknown' : datum.Country",
      "as": "Country_fixed"
    },
    {
      "calculate": "datum['video views'] < 1000 ? 'N/A' : format(datum['video views'], ',d')",
      "as": "views_fixed"
    },
    {
      "calculate": "datum.uploads < 10 ? 'N/A' : format(datum.uploads, ',d')",
      "as": "uploads_fixed"
    }
  ],
  "params": [
    {
      "name": "slider_rank",
      "value": 15,
      "bind": {
        "input": "range",
        "min": 1,
        "max": 50,
        "step": 1,
        "name": "Number of Top Channels "
      }
    }
  ],
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "Youtuber",
      "type": "nominal",
      "title": "YouTube Channel",
      "sort": "-y",
      "axis": {"labelAngle": -45}
    },
    "y": {
      "field": "subscribers",
      "type": "quantitative",
      "title": "Subscribers",
      "axis": {"format": ",d"}
    },
    "color": {
      "field": "Country_fixed",
      "type": "nominal",
      "title": "Country",
      "scale": {
        "domain": [
          "Argentina",
          "Brazil",
          "Canada",
          "Chile",
          "India",
          "Japan",
          "Russia",
          "South Korea",
          "United Kingdom",
          "United States",
          "Unknown"
        ],
        "range": [
          "#a6cee3",
          "#1f78b4",
          "#b2df8a",
          "#33a02c",
          "#fb9a99",
          "#e31a1c",
          "#fdbf6f",
          "#ff7f00",
          "#cab2d6",
          "#6a3d9a",
          "#ffff99"
        ]
      }
    },
    "tooltip": [
      {"field": "rank", "type": "nominal", "title": "Rank"},
      {"field": "Youtuber", "type": "nominal", "title": "Channel"},
      {
        "field": "subscribers",
        "type": "quantitative",
        "title": "Subscribers",
        "format": ",d"
      },
      {"field": "Country_fixed", "type": "nominal", "title": "Country"},
      {"field": "views_fixed", "type": "nominal", "title": "Video Views"},
      {"field": "uploads_fixed", "type": "nominal", "title": "Uploads"}
    ]
  },
  "config": {}
}